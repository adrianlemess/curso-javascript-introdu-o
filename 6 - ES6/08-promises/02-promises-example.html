<!DOCTYPE html>
<html>

<head>
    <title>02 - Promises Example</title>
</head>

<body>
</body>

<script>
    const posts = fetch('https://jsonplaceholder.typicode.com/posts');

    // pending
    // resolved
    // rejected

    posts
        .then(data => console.log(data));
    //     .then(data => data.json())
    //     .then(data => data.map(post => {
    //         console.log(post.title);
    //     }));

    const startLoadingPosts = (flag) => {
        console.log('loading', flag);
    }

    const getArrayTitulos = (arrayPosts) => {
        return arrayPosts.map(post => post.title);
    }

    const handlerError = err => alert('Deu erro');

    const buscarPosts = () => {
        startLoadingPosts(true);
        return fetch('https://jsonplaceholder.typicode.com/posts')
            .then(data => data.json())
            .then(getArrayTitulos)
            .catch(handlerError)
            .finally(() => startLoadingPosts(false))
    }

    buscarPosts()
        .then(resultado => console.log(resultado))

</script>

</html>